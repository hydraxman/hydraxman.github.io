

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/images/favicon.svg">
  <link rel="icon" href="/images/favicon.svg">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#ffffff">
  <meta name="author" content="Nathan">
  <meta name="keywords" content="计算机技术, 生活中的胡思乱想">
  
    <meta name="description" content="What is Java bytecode?Java bytecode is the instruction set of the Java virtual machine (JVM).  From https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Java_bytecode   In a word, just like X86 and ARM or MIPS running on ea">
<meta property="og:type" content="article">
<meta property="og:title" content="Java bytecode and AOP">
<meta property="og:url" content="https://hydraxman.github.io/2018/12/31/more-about-java-bytecode-and-aop/index.html">
<meta property="og:site_name" content="内森淼文">
<meta property="og:description" content="What is Java bytecode?Java bytecode is the instruction set of the Java virtual machine (JVM).  From https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Java_bytecode   In a word, just like X86 and ARM or MIPS running on ea">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hydraxman.github.io/2018/12/31/more-about-java-bytecode-and-aop/13.png">
<meta property="article:published_time" content="2018-12-31T01:18:28.000Z">
<meta property="article:modified_time" content="2026-02-20T09:22:12.120Z">
<meta property="article:author" content="Nathan">
<meta property="article:tag" content="AOP">
<meta property="article:tag" content="面向切面">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="JVM">
<meta property="article:tag" content="bytecode">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://hydraxman.github.io/2018/12/31/more-about-java-bytecode-and-aop/13.png">
  
  
  
  <title>Java bytecode and AOP - 内森淼文</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"hydraxman.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":true,"scope":["home"]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#2979FF","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 60vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>内森淼文</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/images/banner-dark.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.4)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle">Java bytecode and AOP</span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2018-12-31 09:18" pubdate>
          2018年12月31日 上午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          142 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          2 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar category-bar" style="margin-right: -1rem">
    





<div class="category-list">
  
  
    
    
    
    <div class="category row nomargin-x">
      <a class="category-item 
          list-group-item category-item-action col-10 col-md-11 col-xm-11" title="代码手记"
        id="heading-744bc9f0692e342d19e268f9ad8ff775" role="tab" data-toggle="collapse" href="#collapse-744bc9f0692e342d19e268f9ad8ff775"
        aria-expanded="true"
      >
        代码手记
        <span class="list-group-count">(11)</span>
        <i class="iconfont icon-arrowright"></i>
      </a>
      
      <div class="category-collapse collapse show" id="collapse-744bc9f0692e342d19e268f9ad8ff775"
           role="tabpanel" aria-labelledby="heading-744bc9f0692e342d19e268f9ad8ff775">
        
        
          
  <div class="category-post-list">
    
    
      
      
        <a href="/2022/11/01/what-is-good-code/" title="什么是好代码？"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">什么是好代码？</span>
        </a>
      
    
      
      
        <a href="/2022/11/01/plantuml-get-started/" title="PlantUML指北：用UML设计和规划你的项目"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">PlantUML指北：用UML设计和规划你的项目</span>
        </a>
      
    
      
      
        <a href="/2022/11/01/the-nature-of-code/" title="编程的本质"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">编程的本质</span>
        </a>
      
    
      
      
        <a href="/2022/10/15/design-patterns-all-in-one/" title="15分钟入门23种设计模式：图解，范例和对比"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">15分钟入门23种设计模式：图解，范例和对比</span>
        </a>
      
    
      
      
        <a href="/2018/12/31/more-about-java-bytecode-and-aop/" title="Java bytecode and AOP"
           class="list-group-item list-group-item-action
           active">
          <span class="category-post">Java bytecode and AOP</span>
        </a>
      
    
      
      
        <a href="/2018/12/27/aop-in-android/" title="Aspect-Oriented Programming in Android"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Aspect-Oriented Programming in Android</span>
        </a>
      
    
      
      
        <a href="/2018/07/13/java-calendar-story/" title="代码中的人文故事：从一个Java的“Bug”说起"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">代码中的人文故事：从一个Java的“Bug”说起</span>
        </a>
      
    
      
      
        <a href="/2017/03/11/jvm-classcode-practice/" title="一次Java字节码插桩实战"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">一次Java字节码插桩实战</span>
        </a>
      
    
      
      
        <a href="/2017/03/07/jvm-classcode-tutorial/" title="白话Java字节码指令"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">白话Java字节码指令</span>
        </a>
      
    
      
      
        <a href="/2017/02/26/java-classcode-edit-toolkit/" title="Java字节码修改神器HiBeaver：黑掉你的SDK"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Java字节码修改神器HiBeaver：黑掉你的SDK</span>
        </a>
      
    
      
      
        <a href="/2017/02/06/gradle-debug-tips/" title="Gradle插件开发秘籍之断点调试（基于Intellij）"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Gradle插件开发秘籍之断点调试（基于Intellij）</span>
        </a>
      
    
  </div>

        
      </div>
    </div>
  
</div>


  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">Java bytecode and AOP</h1>
            
            
              <div class="markdown-body">
                
                <h2 id="What-is-Java-bytecode"><a href="#What-is-Java-bytecode" class="headerlink" title="What is Java bytecode?"></a>What is Java bytecode?</h2><p>Java bytecode is the instruction set of the Java virtual machine (JVM). </p>
<p>From <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Java_bytecode">https://en.wikipedia.org/wiki/Java_bytecode</a>  </p>
<p>In a word, just like X86 and ARM or MIPS running on each ABI platform, Java bytecode is executed by JVM engine. And as a machine language defined by JVM specification, Java bytecode plays a much more fundamental part in Java ecosystem than Java language itself. The following picture can be the best case to cast light upon it. </p>
<p><img src="/2018/12/31/more-about-java-bytecode-and-aop/13.png" srcset="/img/loading.gif" lazyload alt="JVM ecosystem"></p>
<p><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/specs/index.html">https://docs.oracle.com/javase/specs/index.html</a> </p>
<span id="more"></span>

<p>JVM handles the platform independency. </p>
<p>A Java programmer does not need to be aware of or understand Java bytecode at all. However, as suggested in the IBM developerWorks journal, “Understanding bytecode and what bytecode is likely to be generated by a Java compiler helps the Java programmer in the same way that knowledge of assembly helps the C or C++ programmer.” </p>
<h2 id="An-anatomy-of-the-class-file"><a href="#An-anatomy-of-the-class-file" class="headerlink" title="An anatomy of the .class file"></a>An anatomy of the .class file</h2><p>Class file dissemble </p>
<p>Use this java source code as an example: </p>
<p>Java method data structure: </p>
<p><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html">https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html</a> </p>
<h2 id="Stack-Based-Architecture"><a href="#Stack-Based-Architecture" class="headerlink" title="Stack-Based Architecture?"></a>Stack-Based Architecture?</h2><p>All the instructions is centered by the Stack-Based Architecture and methodology of JVM. This largely simplifies the instruction set of JVM and therefore make it possible that the opcode size could be limited to 8 bit. </p>
<p>In JVM for each thread, a last-in-first-out (LIFO) stack, also known as its JVM stack, is allocated where Java frames are stored. Here is an illustration showing stacks for 3 threads. </p>
<p>A new Java frame is created each time a method is invoked and is destroyed when its method invocation completes. It is used to store data and partial results, as well as to perform dynamic linking, return values for methods, and dispatch exceptions. </p>
<h3 id="Operand-Stacks"><a href="#Operand-Stacks" class="headerlink" title="Operand Stacks"></a>Operand Stacks</h3><p>As opposed to a register-based architecture, stack based one will use stack data structure as its instruction executing and computing playground and notepad, which means each instruction execution will be companied with stack operations like pop and push. The operand stack is empty when the frame that contains it is created, and will normally be empty when the invokation of the corresponding method is completed. </p>
<h3 id="Local-Variables-table"><a href="#Local-Variables-table" class="headerlink" title="Local Variables table"></a>Local Variables table</h3><p>It is a bit reckless to jump to conclusion that JVM is stack-based as JVM also use local variable table during it bytecode execution, which make JVM a bit more register-based. Each frame contains an table of variables known as its local variables table. The length of the local variable array of a frame is determined at compile-time. </p>
<p>So based on this understanding, let’s take a look at a more complicated method, setServiceType(String): </p>
<p>Each frame for a method call has an “operand stack” and an array of “local variables”. </p>
<h3 id="Instruction-types"><a href="#Instruction-types" class="headerlink" title="Instruction types"></a>Instruction types</h3><p>The byte-long and 256 possible opcode instructions fall into a number of broad groups: </p>
<ul>
<li>Load and store (e.g. aload_0, istore) </li>
<li>Arithmetic andc (e.g logi. ladd, fcmpl) </li>
<li>Type conversion (e.g. i2b, d2i) </li>
<li>Object creation and manipulation (new, putfield) </li>
<li>Operand stack management (e.g. swap, dup2) </li>
<li>Control transfer (e.g. ifeq, goto) </li>
<li>Method invocation and return (e.g. invokespecial, areturn)</li>
</ul>
<table>
<thead>
<tr>
<th>Prefix&#x2F;suffix</th>
<th>Operand type</th>
</tr>
</thead>
<tbody><tr>
<td>i</td>
<td>integer</td>
</tr>
<tr>
<td>l</td>
<td>long</td>
</tr>
<tr>
<td>s</td>
<td>short</td>
</tr>
<tr>
<td>b</td>
<td>byte</td>
</tr>
<tr>
<td>c</td>
<td>character</td>
</tr>
<tr>
<td>f</td>
<td>float</td>
</tr>
<tr>
<td>d</td>
<td>double</td>
</tr>
<tr>
<td>a</td>
<td>reference</td>
</tr>
</tbody></table>
<p><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html">https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html</a> </p>
<h3 id="Bytecode-manipulation"><a href="#Bytecode-manipulation" class="headerlink" title="Bytecode manipulation"></a>Bytecode manipulation</h3><p>The most powerful and widely used manipulation tool: </p>
<p>ASM </p>
<p>Site: <a target="_blank" rel="noopener" href="https://asm.ow2.io/">https://asm.ow2.io/</a> </p>
<p>Used in: </p>
<ul>
<li>OpenJDK </li>
<li>Groovy and Kotlin compiler</li>
<li>CGLIB </li>
<li>AspectJ </li>
<li>Gradle </li>
<li>……</li>
</ul>
<p>It is the fundament of compile-time AOP, basically by applying ASM API we can analyze and modify class file method call after source code compile. </p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E4%BB%A3%E7%A0%81%E6%89%8B%E8%AE%B0/" class="category-chain-item">代码手记</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/AOP/" class="print-no-link">#AOP</a>
      
        <a href="/tags/%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2/" class="print-no-link">#面向切面</a>
      
        <a href="/tags/Java/" class="print-no-link">#Java</a>
      
        <a href="/tags/JVM/" class="print-no-link">#JVM</a>
      
        <a href="/tags/bytecode/" class="print-no-link">#bytecode</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Java bytecode and AOP</div>
      <div>https://hydraxman.github.io/2018/12/31/more-about-java-bytecode-and-aop/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Nathan</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2018年12月31日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="NC - 非商业性使用">
                    <i class="iconfont icon-cc-nc"></i>
                  </span>
                </a>
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="SA - 相同方式共享">
                    <i class="iconfont icon-cc-sa"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/10/15/design-patterns-all-in-one/" title="15分钟入门23种设计模式：图解，范例和对比">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">15分钟入门23种设计模式：图解，范例和对比</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2018/12/27/aop-in-android/" title="Aspect-Oriented Programming in Android">
                        <span class="hidden-mobile">Aspect-Oriented Programming in Android</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  



  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});

    Fluid.utils.listenDOMLoaded(function() {
      Fluid.events.registerRefreshCallback(function() {
        if ('mermaid' in window) {
          mermaid.init();
        }
      });
    });
  });
</script>






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <br> <span>© 2024 - 2026 内森淼文</span> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>





  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
